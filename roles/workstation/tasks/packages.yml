- name: Download rpmfusion gpg keys
  rpm_key: key={{ item }}
  loop:
    - https://rpmfusion.org/keys?action=AttachFile&do=get&target=RPM-GPG-KEY-rpmfusion-free-fedora-2020
    - https://rpmfusion.org/keys?action=AttachFile&do=get&target=RPM-GPG-KEY-rpmfusion-nonfree-fedora-2020

- name: Enable rpmfusion repos
  dnf:
    name:
      - 'https://download1.rpmfusion.org/free/fedora/rpmfusion-free-release-{{ releasever }}.noarch.rpm'
      - 'https://download1.rpmfusion.org/nonfree/fedora/rpmfusion-nonfree-release-{{ releasever }}.noarch.rpm'

- name: Enable copr repos
  command: dnf copr -y enable {{ item }}
  args:
    warn: false
  loop:
    - jcrd/dovetail
    - jcrd/clipped
    - jcrd/passless

- name: Install packages
  dnf:
    name:
      - ImageMagick
      - abduco
      - atool
      - blueman
      - chromium-freeworld
      - clipped
      - colordiff
      - copr-cli
      - d-feet
      - dovetail
      - exa
      - fedora-packager
      - fedora-review
      - ffmpegthumbnailer
      - flatpak
      - fontawesome-fonts
      - fzf
      - git
      - git-subtree
      - gucharmap
      - htop
      - i3lock
      - kernel-tools
      - kitty
      - liberation-fonts
      - lm_sensors
      - luarocks
      - mosh
      - mpv
      - mupdf
      - neovim
      - passless
      - picom
      - pinentry-gtk
      - progress
      - ps_mem
      - python-neovim
      - python-pillow
      - qutebrowser
      - ranger
      - rofi
      - rpkg
      - sshfs
      - strace
      - sxiv
      - the_silver_searcher
      - tmux
      - toolbox
      - xorg-x11-server-Xephyr
      - zoxide
      - zsh

- name: Set zsh as user shell
  user:
    name: '{{ ansible_user }}'
    shell: /usr/bin/zsh

- name: Add user to mock group
  user:
    name: '{{ ansible_user }}'
    groups: mock
    append: yes

- name: Use Liberation fonts
  copy:
    src: liberation-fonts-local.conf
    dest: /etc/fonts/local.conf

- name: Add flathub flatpak remote
  flatpak_remote:
    name: flathub
    flatpakrepo_url: https://flathub.org/repo/flathub.flatpakrepo
